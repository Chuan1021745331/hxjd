<div class="modal-dialog">
	<div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
				&times;
			</button>
			<h4 class="modal-title" id="defModalLabel">
				图元详情
			</h4>
		</div>
		<form id="form" action="${BPATH}/admin/saveNewPassword" class="form-horizontal form-label-left input_mask">
			<div class="modal-body">
				<div id="contRow" class="row">
					<div class="col-md-12 col-sm-12 col-xs-12">
						<div class="x_panel">
							<div class="x_content">
								<br>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">唯一标示符</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.oid!}' name="jPel.oid">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">代字</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.code!}' name="jPel.code">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">名称</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.pelname!}' name="jPel.pelname">
									</div>
								</div>
								<div class="item form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">阵营</label>
									<div class="col-md-6 col-sm-6 col-xs-12">
										<div class="btn-group" data-toggle="buttons" style="height: 34px;">
											<label  class="btn btn-success <#if pel.camp??> <#if pel.camp=='1'>active</#if> <#else> active </#if>">
												<#if pel.camp??> <#if pel.camp=='0'> 红方 <#else> 蓝方</#if ><#else> checked="checked" </#if>
											</label>
										</div>
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">形状</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.shape!}' name="jPel.location">
									</div>
								</div>

								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">方位</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.location!}' name="jPel.location">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">经度</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.x!}' name="jPel.x">
									</div>
								</div>
								<div class="form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">维度</label>
									<div class="col-md-9 col-sm-9 col-xs-12">
										<input type="text" class="form-control col-md-7 col-xs-12 inputNone" readonly="readonly" value='${pel.y!}' name="jPel.y">
									</div>
								</div>
								<div class="item form-group">
									<label class="control-label col-md-3 col-sm-3 col-xs-12">状态</label>
									<div class="col-md-6 col-sm-6 col-xs-12">
										<div class="btn-group" data-toggle="buttons" style="height: 34px;">
											<label  class="btn btn-success <#if pel.state??> <#if pel.state==1>active</#if> <#else> active </#if>">
												<#if pel.state??> <#if pel.state==3> 开启 <#else> 关闭</#if ><#else> checked="checked" </#if>
											</label>
										</div>
									</div>
								</div>
								<div class="form-group">
									<div id="mapPel" class="col-md-12 col-sm-12 col-xs-12" style="height: 200px;"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
			    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
<!-- 			    <button type="submit" class="btn btn-primary">提交更改</button> -->
			</div>
		</form>
	</div><!-- /.modal-content -->
</div><!-- /.modal -->
<script>
	$(function() {
		ajaxForm("form");
	});
    setTimeout(function () {
        if("${pel.x!}"==""||"${pel.y!}"==""){
            initNone()
        } else{
            init()
            createMarker("${pel.oid!}", parseFloat(${pel.x!}), parseFloat(${pel.y!}));
            addMarkerS();
        }

    },500)

    var map, fs=new Array() ,vL;
    //空地图
    function initNone() {
        map = new ol.Map({
            target: 'mapPel',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM(),

                })
            ],
            view: new ol.View({
                center: ol.proj.transform([37.41, 8.82], 'EPSG:4326', 'EPSG:3857'),
                zoom: 4
            }),
            controls: ol.control.defaults().extend(
                [new ol.control.ScaleLine()]),
            logo: false
        });
    }
    //有图元的地图
    function init() {
        map = new ol.Map({
            target: 'mapPel',
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM(),

                })
            ],
            view: new ol.View({
                center: ol.proj.transform([parseFloat(${pel.x!}), parseFloat(${pel.y!})], 'EPSG:4326', 'EPSG:3857'),
                zoom: 4
            }),
            controls: ol.control.defaults().extend(
                [new ol.control.ScaleLine()]),
            logo: false
        });
    }
    //获取图片
    var styles = [
        new ol.style.Style({
            image: new ol.style.Icon({
                src: cpath + "/img/dot.png"
            })
        })
    ];
    function createMarker(id,x,y) {
        var marker = new ol.Feature({
            geometry : new ol.geom.Point(ol.proj.fromLonLat([x, y]))
        });
        marker.setStyle(styles[0]);
        marker.setId(id);
        marker.set("x",x);
        marker.set("y",y);
        fs.push(marker);

    }
    //新增标注 多次创建，只需调用一次该方法即可添加marker
    function addMarkerS() {
        vL = new ol.layer.Vector({
            source : vectorSource = new ol.source.Vector({
                features : fs
            })
        });
        map.addLayer(vL);
    }

</script>